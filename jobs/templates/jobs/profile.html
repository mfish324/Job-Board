{% extends 'jobs/base.html' %}

{% block title %}My Profile - Real Jobs, Real People{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1>My Profile</h1>
        <a href="{% url 'edit_profile' %}" class="btn">Edit Profile</a>
    </div>
    
    <div class="job-card">
        <h3>Account Information</h3>
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        {% if user.first_name or user.last_name %}
        <p><strong>Name:</strong> {{ user.first_name }} {{ user.last_name }}</p>
        {% endif %}
        <p><strong>Member since:</strong> {{ user.date_joined|date:"F d, Y" }}</p>
        {% if user.userprofile %}
            <p><strong>Account type:</strong> {{ user.userprofile.get_user_type_display }}</p>
            {% if user.userprofile.phone %}
            <p><strong>Phone:</strong> {{ user.userprofile.phone }}</p>
            {% endif %}
        {% endif %}
    </div>
    
    {% if user.userprofile and user.userprofile.user_type == 'job_seeker' %}
    <div class="job-card">
        <h3>Professional Information</h3>
        {% if user.userprofile.resume %}
        <p><strong>Resume:</strong> 
            <a href="{{ user.userprofile.resume.url }}" target="_blank" style="color: #3498db;">
                ðŸ“„ View Resume
            </a>
        </p>
        {% else %}
        <p><strong>Resume:</strong> <span style="color: #e74c3c;">Not uploaded</span> - 
            <a href="{% url 'edit_profile' %}" style="color: #3498db;">Upload now</a>
        </p>
        {% endif %}
        <p><strong>Experience:</strong> {{ user.userprofile.experience_years }} years</p>
        {% if user.userprofile.skills %}
        <p><strong>Skills:</strong> {{ user.userprofile.skills }}</p>
        {% endif %}
    </div>
    
    <div class="job-card">
        <h3>My Job Applications</h3>
        {% if user_applications %}
            {% for application in user_applications %}
            <div style="padding: 1rem; background: #f9f9f9; margin-bottom: 1rem; border-radius: 3px;">
                <h4>{{ application.job.title }}</h4>
                <p class="job-meta">
                    {{ application.job.company }} | 
                    Applied: {{ application.applied_date|date:"M d, Y" }} |
                    Status: 
                    {% if application.status == 'accepted' %}
                        <span style="font-weight: bold; color: #27ae60;">{{ application.get_status_display }}</span>
                    {% elif application.status == 'rejected' %}
                        <span style="font-weight: bold; color: #e74c3c;">{{ application.get_status_display }}</span>
                    {% else %}
                        <span style="font-weight: bold; color: #f39c12;">{{ application.get_status_display }}</span>
                    {% endif %}
                </p>
                {% if application.custom_resume %}
                <p>ðŸ“Ž Custom resume uploaded for this application</p>
                {% endif %}
                <a href="{% url 'job_detail' application.job.id %}" style="color: #3498db;">View Job â†’</a>
            </div>
            {% endfor %}
        {% else %}
            <p>You haven't applied to any jobs yet.</p>
            <a href="{% url 'job_list' %}" class="btn">Browse Jobs</a>
        {% endif %}
    </div>
    {% endif %}
    
    {% if user.userprofile and user.userprofile.user_type == 'employer' %}
    <div class="job-card">
        <h3>Company Information</h3>
        <p><strong>Company:</strong> {{ user.userprofile.company_name }}</p>
        {% if user.userprofile.company_website %}
        <p><strong>Website:</strong> <a href="{{ user.userprofile.company_website }}" target="_blank" style="color: #3498db;">{{ user.userprofile.company_website }}</a></p>
        {% endif %}
        {% if user.userprofile.company_logo %}
        <p><strong>Logo:</strong></p>
        <img src="{{ user.userprofile.company_logo.url }}" alt="Company Logo" style="max-width: 200px; border-radius: 5px;">
        {% endif %}
        {% if user.userprofile.company_description %}
        <p><strong>Description:</strong> {{ user.userprofile.company_description }}</p>
        {% endif %}
        <p style="margin-top: 1rem;">
            <a href="{% url 'employer_dashboard' %}" class="btn">Go to Dashboard</a>
        </p>
    </div>
    {% endif %}
</div>
{% endblock %}